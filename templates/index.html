{% extends 'base.html' %} {% block content %}
<div id="callout-text">
  <section class="img-wrapper callout-container row">
    <div class="col-10 col-md-8">
      {% if not session['logged_in']%}
      <p class="text-oswald white callout-main-text">
        Tired of having a long list of bookmarks and no Idea of what you
        bookmarked, when you bookmarked it and why? The answer to all your
        problems is here organize your bookmarks with our bookmarks organiser
        app. Please register and then login In to use the app.
      </p>
      {% endif %} {% if session['logged_in']%}
      <p class="text-oswald white callout-main-text">
        You are now logged In an free to add, delete update and create your
        bookmarks collection. Head to the my bookmarks section to start your own
        unique collection.Please check out other users bookmarks below. Feel
        free to click the like button on ones you find usefull.
      </p>
      {% endif %}
      <div class="row justify-content-center">
        {% if not session['logged_in']%}
        <button type="button" class="data-btn col-md-3  btn-primary">
          <a href="{{url_for('register')}}" class="text-oswald white">
            Register here</a
          >
        </button>
        {% endif %} {% if session['logged_in']%}
        <button type="button" class="data-btn col-md-3  btn-primary">
          <a href="{{url_for('users')}}" class="text-oswald white">
            My Bookmarks</a
          >
        </button>
        {% endif %}
      </div>
    </div>
  </section>
</div>
{% if session['logged_in']%}
<section class="bookmark-page">
  <div class="row justify-content-center mt-4">
    <div class="col-lg-4">
      <h2 class="bookmarks-header text-oswald mt-5 text-center uppercase">
        Most Popular Bookmarks
        <hr class="hr-color" />
      </h2>
    </div>
  </div>

  <!-- search bar section -->
  <div class="row  mt-2">
    <div class="col text-center">
      <form action="{{ url_for('search_results') }}" method="POST">
        <div class="row justify-content-center">
          <input
            class="col-8"
            type="text"
            id="search_bar"
            name="search_bar"
            placeholder="Search all bookmarks"
          />
          <button class="btn-primary text-barlow col-1" type="submit">
            Go
          </button>
        </div>
      </form>
    </div>
  </div>
  <!-- end search bar section -->
  <!-- bookmarks section -->
  <div class="row">
    {%for cat in categories%} {% for book in bookmarks %}

    <div class="col-lg-6">
      <div class="card">
        <div class="card-body text-center">
          {% if cat.category_name == book.category_name %} {%endif%}
          <h2 class="card-title text-oswald uppercase">
            {{book.category_name| truncate(30, killwords=True) }}
          </h2>
          <hr class="hr-color" />
          <p class="card-text text-barlow">
            <a href="{{book.add_bookmark_url}}" target="_blank"
              >{{book.add_bookmark_url| truncate(30, killwords=True) }}</a
            >
          </p>
          <p class="card-text">
            {{book.bookmark_description |truncate (50, killwords=True) }}
          </p>
          {%if book.name== users.name%}
          <p class="card-text text-barlow">
            Added by
            <mark class="text-dark">{{book.username}}</mark>
            on {{book.last_modified}}
          </p>
          {%endif%}

          <div class="row mb-3">
            <!-- to prevent user from liking there own bookmark -->
            {%if book.username != session['username']%}
            <a
              href="{{ url_for('upvote', book_id=book._id,_anchor='like_btn') }}"
              class="upvote col   
              "
              ><i class="fas fa-thumbs-up  upvote"></i> Like</a
            >
            {%endif%}
          </div>
          <div class="row">
            <p class="col card-text text-barlow">
              <!-- if likes are  one user is displayed for any other number users is displayed -->
              Liked by {% if book.upvotes == 1%}
              <span class="text-primary mx-2">{{book.upvotes}}</span>Other user
              {%else%}
              <span class="text-primary mx-2">{{book.upvotes}}</span>Other users
              {%endif%}
            </p>
          </div>
          <!-- delete button can only be seen on users own bookmarks -->
          {%if book.username == session['username']%}
          <a href="{{url_for('delete_bookmark', book_id=book._id)}}">
            <button type="button" class="btn btn-primary btn-sm mt-2">
              Delete
            </button></a
          >
          {%endif%}
        </div>
      </div>
    </div>

    {%endfor%}{%endfor%}
  </div>
</section>
{%include 'partials/pagination.html'%} {%endif%} {% endblock content %}
